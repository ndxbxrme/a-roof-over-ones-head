.main.container
  .panel
    form.form-inline(ng-submit='getAreas()')
      .col-sm-6(style='padding: 10px')
        .input-group(style='width:100%')
          input.form-control(type='text', ng-model='storage.area', placeholder='Areas, seperated by commas')
          .input-group-btn
            input.btn.btn-primary(type='submit', value='Search')
      .col-sm-6
        div(range-slider='', model-min='priceRange.min', model-max='priceRange.max', min='1', max='150', filter="rangeFilter:'Â£'", show-values='true')
  .col-sm-8
    .selected-image.text-center(ng-show='selectedImage', ng-click='selectImage(undefined)')
      img(ng-src='{{selectedImage}}', title='Click to close')
      a.close-btn(href='') &times;
    ui-gmap-google-map(center='map.center', zoom='map.zoom', bounds='map.bounds', ng-hide='selectedImage')
      ui-gmap-marker(idKey='selected.guid', coords='selected', ng-if='selected')
      ui-gmap-marker(ng-repeat="listing in listings | unique:'guid' | inPriceRange:priceRange", idKey='listing.lister_url', coords='listing', icon='{url:listing.thumb_url}', options="{title:listing.title + ': ' + listing.price_formatted, class:'icon'}", click='selectListing(listing)', ng-if='!isHidden(listing)')
  .selected-property.scroller.col-sm-4(ng-nicescroll='', ng-show='selected')
    h4.col-xs-12.no-margin {{ selected.title }} - &nbsp;
      a(ng-href='{{listing.lister_url}}', target='_Blank') Website
    .col-xs-12
      h5.pull-left {{ selected.price_formatted }}
      button.btn.btn-primary.pull-right.margin-bottom(ng-click='addToFavorites(selected)', ng-show='$root.currentUser && !isFavorite(selected)') Add to favorites
      button.btn.btn-disabled.pull-right.margin-bottom(ng-hide='$root.currentUser') Sign in to favorite
      h4.pull-right(ng-show='isFavorite(selected)')
        a(href='favorites') Favorite
    .listing.col-sm-6(ng-repeat='pic in selected.pics')
      img.thumbnail(ng-src='{{pic}}', style='width: 100%', onerror="this.style.display='none'", ng-click="selectImage(pic)")
  .col-sm-4.greyed-out(ng-hide='selected')
    div(ng-show='listings.length>0')
      h4.col-xs-12.no-margin Click an image on the map
      h5.col-xs-12 and the selected property will show here
      .listing.col-sm-6(ng-repeat='pic in [1,2,3,4]')
        img.thumbnail(ng-src='http://placehold.it/160x123?text=Image', style='width: 100%')
    div(ng-hide="listings.length>0 || response.application_response_code==='202'")
      h4.col-xs-12.no-margin Search for an area to get started
      p.col-xs-12 Find and compare UK properites quickly and simply.
      p.col-xs-12 Enter a comma seperated list of the areas you are interested in then use the price slider above to narrow down the results.
      p.col-xs-12 Sign in to save favorites.
    div(ng-show="response.application_response_code==='202'")
      h4.no-margin Area not found
      h5 Did you mean...?
      div(ng-repeat='location in response.locations')
        h4 
          a(href='', ng-click='searchFor(location.place_name)') {{ location.long_title }}
  .col-sm-4
    h4.text-center(ng-show='loading') Loading properties...&nbsp;&nbsp;
      i.fa.fa-spinner.fa-spin
  .search-listings
    .col-xs-12.panel.panel-default(ng-repeat="listing in listings | unique:'guid' | inPriceRange:priceRange | orderBy:'price'", ng-hide='isHidden(listing)')
      a(name='{{ listing.guid }}')
      .col-sm-6
        h4
          a(href='', ng-click='selectListingAndImage(listing, null)') {{ listing.title }}
        h5 {{ listing.summary }}
          a(ng-href='{{listing.lister_url}}', target='_Blank') Website
      .col-sm-6.text-right   
        h4 {{ listing.price_formatted }}
        .btn-group.pull-right(role='group', ng-hide='isFavorite(listing)')
          button.btn.btn-default.margin-bottom(ng-click='hide(listing)', ng-show='$root.currentUser', type='button') Hide
          button.btn.btn-primary.margin-bottom(ng-click='addToFavorites(listing)', ng-show='$root.currentUser', type='button') Add to favorites
        button.btn.btn-disabled.pull-right.margin-bottom(ng-hide='$root.currentUser', type='button') Sign in to favorite
        h4.pull-right(ng-show='isFavorite(listing)')
          a(href='favorites') Favorite
      .col-sm-12
        .listing.col-sm-2(ng-repeat='pic in listing.pics')
          //.afkl-lazy-wrapper.afkl-img-ratio-1-1.thumbnail(afkl-lazy-image='{{pic}}', ng-click='selectListingAndImage(listing, pic)')
          img.thumbnail(ng-src='{{pic}}', style='width: 100%', onerror="this.style.display='none'", ng-click='selectListingAndImage(listing, pic)')
        .listing.col-sm-2
          img.thumbnail(ng-src='{{ listing.img_url }}', ng-hide='listing.pics.length>0' style='width: 100%', ng-click='selectListingAndPic(listing, img_url)')
      //a(ng-click='getImages(listing)')
        img(ng-src='{{listing.img_url}}', style='width: 100%')